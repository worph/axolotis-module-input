var c=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var w=(i,t)=>{for(var e in t)c(i,e,{get:t[e],enumerable:!0})},x=(i,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of k(t))!L.call(i,n)&&n!==e&&c(i,n,{get:()=>t[n],enumerable:!(a=S(t,n))||a.enumerable});return i};var M=i=>x(c({},"__esModule",{value:!0}),i);var T={};w(T,{AxInputModule:()=>b,Compound1DInput:()=>m,Compound2DInput:()=>f,InputService:()=>o,InputServiceName:()=>l,KeyboardKey:()=>p,MouseAxis:()=>y,MouseButton:()=>u,MouseWheel:()=>v});module.exports=M(T);var d=require("inversify");var l=Symbol.for("InputServiceName");var p=class{constructor(t,e="any"){this.keyCode=t;this.type=e}getType(){return"keyboard"}},u=class{constructor(t="Mouse-0",e="any"){this.btn=t;this.type=e}getType(){return"mouse_click"}},v=class{constructor(t="any"){this.type=t}getType(){return"mouse_wheel"}},y=class{constructor(t="x"){this.type=t}getType(){return"mouse_axis"}},m=class{constructor(t,e){this.eventXPositive=t;this.eventXNegative=e}getType(){return"compound_1d"}},f=class{constructor(t,e){this.eventX=t;this.eventY=e}getType(){return"compound_2d"}},h=class{constructor(t){this.parent=t}setupListeners(t){t.addEventListener("mousedown",e=>{this.checkMouseEvent(e,"mousedown")}),t.addEventListener("mouseup",e=>{this.checkMouseEvent(e,"mouseup")}),t.addEventListener("mouseout",e=>{this.checkMouseEvent(e,"mouseup")}),t.addEventListener("mousemove",e=>{for(let a in this.parent.inputList)for(let n of this.parent.inputList[a])if(n.getType()==="mouse_axis"){let r=n;r.type==="x"&&this.parent.notifyScalar(a,{sourceEvt:e,actionName:a,state:e.offsetX}),r.type==="y"&&this.parent.notifyScalar(a,{sourceEvt:e,actionName:a,state:e.offsetY})}}),t.addEventListener("wheel",e=>{for(let a in this.parent.inputList)for(let n of this.parent.inputList[a])if(n.getType()==="mouse_wheel"){let r=n;if(r.type==="up")throw new Error("not yet implemented");if(r.type==="down")throw new Error("not yet implemented");this.parent.notifyScalar(a,{sourceEvt:e,actionName:a,state:e.deltaY})}})}checkMouseEvent(t,e){let a="Mouse-"+t.button;for(let n in this.parent.inputList)for(let r of this.parent.inputList[n])if(r.getType()==="mouse_click"){let s=r;s.btn==a&&(e===s.type||s.type==="any")&&(this.parent.notifyBoolean(n,{sourceEvt:t,actionName:n,state:e==="mousedown"}),this.parent.notifyScalar(n,{sourceEvt:t,actionName:n,state:e==="mousedown"?1:0}))}}},g=class{constructor(t){this.parent=t}setupListeners(){window.addEventListener("keyup",t=>{this.checkKeyBoardEvent(t)}),window.addEventListener("keydown",t=>{this.checkKeyBoardEvent(t)})}checkKeyBoardEvent(t){if(t.repeat==!1){for(let e in this.parent.inputList)for(let a of this.parent.inputList[e])if(a.getType()==="keyboard"){let n=a;n.keyCode==t.code&&(t.type===n.type||n.type==="any")&&(this.parent.notifyBoolean(e,{sourceEvt:t,actionName:e,state:t.type==="keydown"}),this.parent.notifyScalar(e,{sourceEvt:t,actionName:e,state:t.type==="keydown"?1:0}))}}}},E=class{constructor(t){this.parent=t}notifyActionOn(t){for(let e in this.parent.inputList)for(let a of this.parent.inputList[e]){if(a.getType()==="compound_1d"){let n=a;if(n.eventXPositive===t||n.eventXNegative===t){let r=this.parent.getScalarEvent(n.eventXPositive),s=this.parent.getScalarEvent(n.eventXNegative);r&&s&&this.parent.notifyScalar(e,{sourceEvt:{eventXPos:r,eventXNeg:s},actionName:e,state:r.state-s.state})}}if(a.getType()==="compound_2d"){let n=a;if(n.eventX===t||n.eventY===t){let r=this.parent.getScalarEvent(n.eventX),s=this.parent.getScalarEvent(n.eventY);r&&s&&this.parent.notify2DScalar(e,{sourceEvt:{eventX:r,eventY:s},actionName:e,state:{x:r.state,y:s.state}})}}}}},o=class{inputList={};booleanCallbackList={};scalarCallbackList={};scalar2DCallbackList={};booleanState={};scalarState={};scalar2DState={};compoundManager;keyboardManager;mouseManager;constructor(){this.keyboardManager=new g(this),this.mouseManager=new h(this),this.compoundManager=new E(this)}initializeCaptureElement(t=null){t||(t=window.document.body),this.keyboardManager.setupListeners(),this.mouseManager.setupListeners(t)}notifyScalar(t,e){if(this.scalarState[t]=e,this.scalarCallbackList[t])for(let a of this.scalarCallbackList[t])a(e);this.compoundManager.notifyActionOn(t)}notify2DScalar(t,e){if(this.scalar2DState[t]=e,this.scalarCallbackList[t])for(let a of this.scalar2DCallbackList[t])a(e)}notifyBoolean(t,e){if((!this.booleanState[t]||this.booleanState[t].state!=e.state)&&(this.booleanState[t]=e,this.booleanCallbackList[t]))for(let a of this.booleanCallbackList[t])a(e)}register(t,e){this.inputList[t]||(this.inputList[t]=[]),this.inputList[t].push(e)}setBooleanValue(t,e){this.booleanState[t].state,this.notifyBoolean(t,{state:e,actionName:t,sourceEvt:null})}getBooleanValue(t){return this.booleanState[t]?this.booleanState[t].state:!1}getScalarValue(t){return this.scalarState[t]?this.scalarState[t].state:0}getScalar2DValue(t){return this.scalar2DState[t]?this.scalar2DState[t].state:{x:0,y:0}}getBooleanEvent(t){return this.booleanState[t]}getScalarEvent(t){return this.scalarState[t]}getScalar2DEvent(t){return this.scalar2DState[t]}register2DScalarEvent(t,e){return this.registerGeneric(this.scalar2DCallbackList,t,e)}registerScalarEvent(t,e){return this.registerGeneric(this.scalarCallbackList,t,e)}registerBooleanEvent(t,e){return this.registerGeneric(this.booleanCallbackList,t,e)}registerGeneric(t,e,a){return t[e]||(t[e]=[]),t[e].push(a),()=>{t[e].filter(n=>n!=a)}}};var b=class{getModule(){return new d.ContainerModule(t=>{t(l).toDynamicValue(()=>new o).inSingletonScope()})}};0&&(module.exports={AxInputModule,Compound1DInput,Compound2DInput,InputService,InputServiceName,KeyboardKey,MouseAxis,MouseButton,MouseWheel});
//# sourceMappingURL=index.cjs.map