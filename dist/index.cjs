var u=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var x=(i,t)=>{for(var e in t)u(i,e,{get:t[e],enumerable:!0})},M=(i,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of k(t))!L.call(i,n)&&n!==e&&u(i,n,{get:()=>t[n],enumerable:!(r=S(t,n))||r.enumerable});return i};var I=i=>M(u({},"__esModule",{value:!0}),i);var T={};x(T,{AxInputModule:()=>E,Compound1DInput:()=>f,Compound2DInput:()=>v,CompoundManager:()=>s,InputService:()=>l,InputServiceName:()=>m,KeyboardKey:()=>y,KeyboardManager:()=>p,MouseAxis:()=>d,MouseButton:()=>g,MouseManager:()=>c,MouseWheel:()=>h});module.exports=I(T);var b=require("inversify");var m=Symbol.for("InputServiceName");var s=class{constructor(t){this.parent=t}notifyActionOn(t){for(let e in this.parent.getActionList())for(let r of this.parent.getActionList()[e]){if(r.getType()==="compound_1d"){let n=r;if(n.eventXPositive===t||n.eventXNegative===t){let o=this.parent.getScalarEvent(n.eventXPositive),a=this.parent.getScalarEvent(n.eventXNegative);o&&a&&this.parent.notifyScalar(e,{sourceEvt:{eventXPos:o,eventXNeg:a},actionName:e,state:o.state-a.state})}}if(r.getType()==="compound_2d"){let n=r;if(n.eventX===t||n.eventY===t){let o=this.parent.getScalarEvent(n.eventX),a=this.parent.getScalarEvent(n.eventY);o&&a&&this.parent.notify2DScalar(e,{sourceEvt:{eventX:o,eventY:a},actionName:e,state:{x:o.state,y:a.state}})}}}}};var p=class{constructor(t){this.parent=t}setupListeners(){window.addEventListener("keyup",t=>{this.checkKeyBoardEvent(t)}),window.addEventListener("keydown",t=>{this.checkKeyBoardEvent(t)})}checkKeyBoardEvent(t){if(t.repeat==!1)for(let e in this.parent.getActionList())for(let r of this.parent.getActionList()[e])r.getType()==="keyboard"&&r.keyCode==t.code&&(this.parent.notifyBoolean(e,{sourceEvt:t,actionName:e,state:t.type==="keydown"}),this.parent.notifyScalar(e,{sourceEvt:t,actionName:e,state:t.type==="keydown"?1:0}))}};var c=class{constructor(t){this.parent=t}setupListeners(t){t.addEventListener("mousedown",e=>{this.checkMouseEvent(e,"mousedown")}),t.addEventListener("mouseup",e=>{this.checkMouseEvent(e,"mouseup")}),t.addEventListener("mouseout",e=>{this.checkMouseEvent(e,"mouseup")}),t.addEventListener("mousemove",e=>{for(let r in this.parent.getActionList())for(let n of this.parent.getActionList()[r])if(n.getType()==="mouse_axis"){let o=n;o.type==="x"&&this.parent.notifyScalar(r,{sourceEvt:e,actionName:r,state:e.offsetX}),o.type==="y"&&this.parent.notifyScalar(r,{sourceEvt:e,actionName:r,state:e.offsetY})}}),t.addEventListener("wheel",e=>{for(let r in this.parent.getActionList())for(let n of this.parent.getActionList()[r])if(n.getType()==="mouse_wheel"){let o=n;if(o.type==="up")throw new Error("not yet implemented");if(o.type==="down")throw new Error("not yet implemented");this.parent.notifyScalar(r,{sourceEvt:e,actionName:r,state:e.deltaY})}})}checkMouseEvent(t,e){let r="Mouse-"+t.button;for(let n in this.parent.getActionList())for(let o of this.parent.getActionList()[n])o.getType()==="mouse_click"&&o.btn==r&&(this.parent.notifyBoolean(n,{sourceEvt:t,actionName:n,state:e==="mousedown"}),this.parent.notifyScalar(n,{sourceEvt:t,actionName:n,state:e==="mousedown"?1:0}))}};var l=class{inputList={};booleanCallbackList={};scalarCallbackList={};scalar2DCallbackList={};booleanState={};scalarState={};scalar2DState={};compoundManager;keyboardManager;mouseManager;constructor(){this.keyboardManager=new p(this),this.mouseManager=new c(this),this.compoundManager=new s(this)}initializeCaptureElement(t=null){t||(t=window.document.body),this.keyboardManager.setupListeners(),this.mouseManager.setupListeners(t)}notifyScalar(t,e){if(this.scalarState[t]=e,this.scalarCallbackList[t])for(let r of this.scalarCallbackList[t])r(e);this.compoundManager.notifyActionOn(t)}notify2DScalar(t,e){if(this.scalar2DState[t]=e,this.scalarCallbackList[t])for(let r of this.scalar2DCallbackList[t])r(e)}notifyBoolean(t,e){if(this.booleanState[t]=e,this.booleanCallbackList[t])for(let r of this.booleanCallbackList[t])(e.sourceEvt.type==="keyup"&&r.type==="UP"||e.sourceEvt.type==="keydown"&&r.type==="DOWN"||r.type==="ANY")&&r.callback(e)}register(t,e){this.inputList[t]||(this.inputList[t]=[]),this.inputList[t].push(e)}setBooleanValue(t,e){this.booleanState[t].state,this.notifyBoolean(t,{state:e,actionName:t,sourceEvt:null})}getBooleanValue(t){return this.booleanState[t]?this.booleanState[t].state:!1}getScalarValue(t){return this.scalarState[t]?this.scalarState[t].state:0}getScalar2DValue(t){return this.scalar2DState[t]?this.scalar2DState[t].state:{x:0,y:0}}getBooleanEvent(t){return this.booleanState[t]}getScalarEvent(t){return this.scalarState[t]}getScalar2DEvent(t){return this.scalar2DState[t]}register2DScalarEvent(t,e){return this.registerGeneric(this.scalar2DCallbackList,t,e)}registerScalarEvent(t,e){return this.registerGeneric(this.scalarCallbackList,t,e)}registerBooleanEvent(t,e,r="ANY"){let n=this.booleanCallbackList,o={callback:e,type:r};return n[t]||(n[t]=[]),n[t].push(o),()=>{n[t].filter(a=>a!=o)}}registerGeneric(t,e,r){return t[e]||(t[e]=[]),t[e].push(r),()=>{t[e].filter(n=>n!=r)}}getActionList(){return this.inputList}};var f=class{constructor(t,e){this.eventXPositive=t;this.eventXNegative=e}getType(){return"compound_1d"}},v=class{constructor(t,e){this.eventX=t;this.eventY=e}getType(){return"compound_2d"}};var y=class{constructor(t){this.keyCode=t}getType(){return"keyboard"}};var g=class{constructor(t="Mouse-0"){this.btn=t}getType(){return"mouse_click"}};var h=class{constructor(t="any"){this.type=t}getType(){return"mouse_wheel"}};var d=class{constructor(t="x"){this.type=t}getType(){return"mouse_axis"}};var E=class{getModule(){return new b.ContainerModule(t=>{t(m).toDynamicValue(()=>new l).inSingletonScope()})}};0&&(module.exports={AxInputModule,Compound1DInput,Compound2DInput,CompoundManager,InputService,InputServiceName,KeyboardKey,KeyboardManager,MouseAxis,MouseButton,MouseManager,MouseWheel});
//# sourceMappingURL=index.cjs.map